{
  "comments": [
    {
      "key": {
        "uuid": "c96e0921_34014813",
        "filename": "fs/ext4/ext4.h",
        "patchSetId": 3
      },
      "lineNbr": 591,
      "author": {
        "id": 1038033
      },
      "writtenOn": "2017-02-04T00:21:23Z",
      "side": 1,
      "message": "I get desire to avoid conflicts with upstream, but if the Android kernel is different upstream, this could theoretically cause problems later.   If this code ever gets used with a device with an SD card, for example.\n\nI would much rather check in a code point reservation for HEH in the fscrypt git tree now, even if the HEH code isn\u0027t upstream yet.",
      "range": {
        "startLine": 591,
        "startChar": 40,
        "endLine": 591,
        "endChar": 41
      },
      "revId": "380104906a40e91d09edcad6ae7212802232c6a5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "10fecc5a_b49b9ad8",
        "filename": "fs/ext4/ext4.h",
        "patchSetId": 3
      },
      "lineNbr": 591,
      "author": {
        "id": 1137063
      },
      "writtenOn": "2017-02-04T01:05:03Z",
      "side": 1,
      "message": "We could, but I am concerned about HEH changing as it gets wider review.  Note that we even made changes fairly recently, from v0 to v1 of the Internet Draft.\n\nAdditionally, the patch after this one makes the non-reversible key derivation method used iff HEH is also used, and this affects the on-disk format for both contents (except when using ICE) and filenames.  Personally I don\u0027t think that is the right approach for upstream; it really should be a flag in the policy \u0027flags\u0027, so that people can use the more secure key derivation algorithm without being forced to use a particular encryption mode.  And I\u0027d like to get it upstream without having it blocked by HEH.  Therefore, if we want to try to be compatible with future changes upstream, then we\u0027d need to reconsider the decision to tie the two changes together as well.\n\nSo since I am skeptical that we will get both format changes \"correct\" right now, I decided to error on the side of putting both changes behind a mode number which is unlikely to be used upstream.  Though any additional insight on this would be appreciated.  (Michael, Alex?)\n\nAlso, are SD cards really a valid concern, given that people generally use FAT32 (and not ext4 or f2fs) on SD cards that are expected to be portable between systems?",
      "parentUuid": "c96e0921_34014813",
      "range": {
        "startLine": 591,
        "startChar": 40,
        "endLine": 591,
        "endChar": 41
      },
      "revId": "380104906a40e91d09edcad6ae7212802232c6a5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "42ab5718_46b7888f",
        "filename": "fs/ext4/ext4.h",
        "patchSetId": 3
      },
      "lineNbr": 591,
      "author": {
        "id": 1038033
      },
      "writtenOn": "2017-02-08T22:29:27Z",
      "side": 1,
      "message": "Makes sense, agreed.\n\nThere has been talk about putting encrypted ext4 on an SDcard in the past, and even at one point an oddball request that we be able to move a file from /data to the SD card and back without having access to the key.  I had some hacky patches that would allow a directory hierarchy to be moved from one file system to another while preserving the encryption nonces, encrypted file names, etc.   It was.... interesting.   Fortunately the userspace feature that was driving this requirement was shelved, so I never had to put that code into production.",
      "parentUuid": "10fecc5a_b49b9ad8",
      "range": {
        "startLine": 591,
        "startChar": 40,
        "endLine": 591,
        "endChar": 41
      },
      "revId": "380104906a40e91d09edcad6ae7212802232c6a5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6f5bf933_41837dad",
        "filename": "fs/ext4/ext4.h",
        "patchSetId": 3
      },
      "lineNbr": 591,
      "author": {
        "id": 1137063
      },
      "writtenOn": "2017-02-09T23:38:43Z",
      "side": 1,
      "message": "Okay, so for now I am leaving the two features behind a special mode number, and I updated the commit messages to clarify the reasoning.\n\nWhen either or both of these features get upstream, I think we\u0027ll just update Android userspace to allow specifying the upstream feature(s) in fstab, as an alternative to this provisional version (which could then be removed from the kernel, for new devices).",
      "parentUuid": "42ab5718_46b7888f",
      "range": {
        "startLine": 591,
        "startChar": 40,
        "endLine": 591,
        "endChar": 41
      },
      "revId": "380104906a40e91d09edcad6ae7212802232c6a5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}