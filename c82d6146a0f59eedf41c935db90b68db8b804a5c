{
  "comments": [
    {
      "key": {
        "uuid": "eb106340_fab709c6",
        "filename": "security/selinux/avc.c",
        "patchSetId": 1
      },
      "lineNbr": 451,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2015-01-15T02:02:50Z",
      "side": 1,
      "message": "This doesn\u0027t seem right.  How does the file code add the \"path\u003d\" call to the audit message? I thought there was some kind of callback that you could register to add these kinds of messages.\n\nHopefully Stephen knows better...",
      "revId": "c82d6146a0f59eedf41c935db90b68db8b804a5c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b0217f8_cae8fbb7",
        "filename": "security/selinux/avc.c",
        "patchSetId": 1
      },
      "lineNbr": 451,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2015-01-15T03:54:41Z",
      "side": 1,
      "message": "Regarding the placement of this code, I agree there very well may be a more appropriate location for it. Perhaps Stephen can suggest one otherwise I will look into it further tomorrow.\n\nI\u0027m not sure that we want a filepath in the audit message here. The way I have this setup, the file check is done with the existing file_has_perm, so doing it again would be redundant. This code is only for checking the ioctl command which has been mapped to a tsid. So two checks, file check, then command check. Perhaps we can consolidate them, but that\u0027s not how it\u0027s currently set up. \n\nThe way policy is written is much like for ports, you map a range of commands to a type\n\nioctlcon 0 - 4294967295 u:object_r:all_ioctls:s0\ntype all_ioctls\n\nthen you can give processes access to this type\n\nallow init all_ioctls:{file socket} ioctl;\n\nWhat I am trying to fix with this additional audit printing is the extremely unhelpful denial messages that it will output:\n\ntype\u003dAVC msg\u003daudit(1363289005.532:184): avc:  denied  { ioclt } for  pid\u003d29199 comm\u003d\"system\" scontext\u003dstaff_u:staff_r:wpa_supplicant_t\ntcontext\u003du:object_r:all_ioclts tclass\u003dfile\n\nThis masks the exact ioctl command that is being denied, instead printing all_ioctls which could be any of 4 billion options that I have assigned to it. I want the offending ioctl command.",
      "parentUuid": "eb106340_fab709c6",
      "revId": "c82d6146a0f59eedf41c935db90b68db8b804a5c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}