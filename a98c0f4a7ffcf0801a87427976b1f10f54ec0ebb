{
  "comments": [
    {
      "key": {
        "uuid": "44141a88_13139668",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.c",
        "patchSetId": 6
      },
      "lineNbr": 11453,
      "author": {
        "id": 1076784
      },
      "writtenOn": "2015-09-04T00:35:07Z",
      "side": 1,
      "message": "No, please use locking here always. The user in thins file that previously called wl_update_wiphybands() with cfg !\u003d NULL (and thus did not use locking) should be calling __wl_update_wiphybands() now.",
      "range": {
        "startLine": 11447,
        "startChar": 0,
        "endLine": 11453,
        "endChar": 2
      },
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44141a88_133276bf",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.c",
        "patchSetId": 6
      },
      "lineNbr": 11453,
      "author": {
        "id": 1072843
      },
      "writtenOn": "2015-09-04T01:36:18Z",
      "side": 1,
      "message": "Once I tried to set locking always, but it failed to power up WiFi. because failed getting usr_sync lock. \n\nIn the original code, it reassign cfg pointer to global one if passed value was NULL. and set mutex for some reason. \n\n\tif (cfg \u003d\u003d NULL) {\n\t\tcfg \u003d g_bcm_cfg;\n\t\tmutex_lock(\u0026cfg-\u003eusr_sync);\n\t\trollback_lock \u003d true;\n\t}\n\nI think we can skip to call __wl_update_wiphybands when cfg\u003d\u003dNULL, then setting mutex is not needed.",
      "parentUuid": "44141a88_13139668",
      "range": {
        "startLine": 11447,
        "startChar": 0,
        "endLine": 11453,
        "endChar": 2
      },
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44141a88_7ed0d131",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.c",
        "patchSetId": 6
      },
      "lineNbr": 11453,
      "author": {
        "id": 1076784
      },
      "writtenOn": "2015-09-04T05:08:41Z",
      "side": 1,
      "message": "If you did that without adjusting caller in this file to use non-locking version then it is not a surprise: you\u0027d try to take this mutex recursively and woudl deadlock.\n\nI am not sure about dropping call to __wl_update_wiphybands(), I\u0027d rather did it in a separate CL.",
      "parentUuid": "44141a88_133276bf",
      "range": {
        "startLine": 11447,
        "startChar": 0,
        "endLine": 11453,
        "endChar": 2
      },
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44141a88_fefa01aa",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.c",
        "patchSetId": 6
      },
      "lineNbr": 11453,
      "author": {
        "id": 1072843
      },
      "writtenOn": "2015-09-04T05:42:31Z",
      "side": 1,
      "message": "Yes, your saying correct. If in case cfg\u003d\u003dNULL passing, then there\u0027s nothing that we can do update through wiphybands. I think tt\u0027s better to see with further test result.",
      "parentUuid": "44141a88_7ed0d131",
      "range": {
        "startLine": 11447,
        "startChar": 0,
        "endLine": 11453,
        "endChar": 2
      },
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "240f267a_374b20a1",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.c",
        "patchSetId": 6
      },
      "lineNbr": 11453,
      "author": {
        "id": 1076784
      },
      "writtenOn": "2015-09-04T06:46:02Z",
      "side": 1,
      "message": "But we never pass cfg\u003d\u003dNULL to wl_update_wiphybands() anymore. Please restore locking, I assume it was there on purpose. If locking is not needed please submit a separate CL describing why it is not needed, as a followup for this one.",
      "parentUuid": "44141a88_fefa01aa",
      "range": {
        "startLine": 11447,
        "startChar": 0,
        "endLine": 11453,
        "endChar": 2
      },
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84529221_51481526",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.h",
        "patchSetId": 6
      },
      "lineNbr": 914,
      "author": {
        "id": 1076784
      },
      "writtenOn": "2015-09-04T00:35:07Z",
      "side": 1,
      "message": "I do not think you need to export this one.",
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6492fe15_15185faf",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.h",
        "patchSetId": 6
      },
      "lineNbr": 914,
      "author": {
        "id": 1072843
      },
      "writtenOn": "2015-09-04T01:36:18Z",
      "side": 1,
      "message": "Yes agreed. Fixed.",
      "parentUuid": "84529221_51481526",
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84529221_b41cd700",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.h",
        "patchSetId": 6
      },
      "lineNbr": 914,
      "author": {
        "id": 1076784
      },
      "writtenOn": "2015-09-04T05:11:44Z",
      "side": 1,
      "message": "No it is not. You still have __wl_update_wiphybands() as a global function. It should be static to wl_cfg80211.c",
      "parentUuid": "6492fe15_15185faf",
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "644d9e85_b8c3b8be",
        "filename": "drivers/net/wireless/bcmdhd/wl_cfg80211.h",
        "patchSetId": 6
      },
      "lineNbr": 914,
      "author": {
        "id": 1072843
      },
      "writtenOn": "2015-09-04T05:42:31Z",
      "side": 1,
      "message": "Oh..Ok. moved to .c file.",
      "parentUuid": "84529221_b41cd700",
      "revId": "a98c0f4a7ffcf0801a87427976b1f10f54ec0ebb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}