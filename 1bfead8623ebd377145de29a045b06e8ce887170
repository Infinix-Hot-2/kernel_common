{
  "comments": [
    {
      "key": {
        "uuid": "e47f9b95_6a6f7fbb",
        "filename": "drivers/gpu/ion/ion.c",
        "patchSetId": 1
      },
      "lineNbr": 107,
      "author": {
        "id": 1000413
      },
      "writtenOn": "2013-09-20T18:55:45Z",
      "side": 1,
      "message": "didn\u0027t you move it to idr?",
      "revId": "1bfead8623ebd377145de29a045b06e8ce887170",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44d6a7dc_745ea625",
        "filename": "drivers/gpu/ion/ion.c",
        "patchSetId": 1
      },
      "lineNbr": 107,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2013-09-20T19:02:18Z",
      "side": 1,
      "message": "Yes, it is an idr integer, but when it gets passed to userspace and back it gets stored in a struct ion_handle *.  Userspace treats it as an opaque pointer, but I didn\u0027t want to change the type exposed to userspace.",
      "parentUuid": "e47f9b95_6a6f7fbb",
      "revId": "1bfead8623ebd377145de29a045b06e8ce887170",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a4a76389_c44c7e78",
        "filename": "drivers/gpu/ion/ion.c",
        "patchSetId": 1
      },
      "lineNbr": 107,
      "author": {
        "id": 1000413
      },
      "writtenOn": "2013-09-20T19:12:00Z",
      "side": 1,
      "message": "well it\u0027s technically not valid to store it in an unsigned long either, should use an intptr_t (or uintptr_t if you so desire).\n\nMy vote is to change the userspace API to be an int32_t (__s32) and bite the bullet. idr_alloc is unfortunately an int, and not sized explicitly so it\u0027s hard to really provide a stable/consistent integer id to userspace anyway. Is this stuff in staging yet?",
      "parentUuid": "44d6a7dc_745ea625",
      "revId": "1bfead8623ebd377145de29a045b06e8ce887170",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44d6a7dc_546fe2ba",
        "filename": "drivers/gpu/ion/ion.c",
        "patchSetId": 1
      },
      "lineNbr": 107,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2013-09-20T19:35:26Z",
      "side": 1,
      "message": "What\u0027s wrong with storing a pointer in an unsigned long?\n\nAll I care is that the integer-sized number generated by idr can be stored in the userspace structure.  I don\u0027t care what happens to an invalid id passed back from userspace - if it gets truncated, sign-extended, etc., it doesn\u0027t matter, its about to get validated anyways.  I don\u0027t see any problem going positive int -\u003e unsigned long -\u003e void * -\u003e unsigned long -\u003e int.\n\nI originally planned to modify userspace, but it turns out there are tons of copies of libion all over the tree, plus various places that call the ion ioctls directly.",
      "parentUuid": "a4a76389_c44c7e78",
      "revId": "1bfead8623ebd377145de29a045b06e8ce887170",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e4c79b62_96668cc2",
        "filename": "drivers/gpu/ion/ion.c",
        "patchSetId": 1
      },
      "lineNbr": 107,
      "author": {
        "id": 1000413
      },
      "writtenOn": "2013-09-24T06:27:35Z",
      "side": 1,
      "message": "Technically, there\u0027s no guarantee that unsigned long will be able to store a ptr (you need an intptr_t for that). However, I think the kernel makes that assumption in other places so other things will break before this does. And I agree that a long here is better than an int :)",
      "parentUuid": "44d6a7dc_546fe2ba",
      "revId": "1bfead8623ebd377145de29a045b06e8ce887170",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}